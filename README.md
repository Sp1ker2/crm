# üìå CRM Application

–õ—ë–≥–∫–∞—è CRM-—Å–∏—Å—Ç–µ–º–∞ –Ω–∞ **FastAPI** —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π, –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç **PostgreSQL** –≤ –∫–∞—á–µ—Å—Ç–≤–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, **Alembic** –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π.

---

## ‚öôÔ∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- ‚ö° [FastAPI](https://fastapi.tiangolo.com/) ‚Äî –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- üêò [PostgreSQL](https://www.postgresql.org/) ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- üõ† [SQLAlchemy](https://www.sqlalchemy.org/) ‚Äî ORM
- üîÑ [Alembic](https://alembic.sqlalchemy.org/) ‚Äî –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
- üì¶ [Poetry](https://python-poetry.org/) ‚Äî –º–µ–Ω–µ–¥–∂–µ—Ä –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

---

## üìä –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### –°–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π –∏ –∏–µ—Ä–∞—Ä—Ö–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
–¢—Ä—ë—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è:
- **ADMIN** ‚Äî —Å–æ–∑–¥–∞—ë—Ç –∫–æ–º–∞–Ω–¥—ã –∏ Team-–ª–∏–¥–µ—Ä–æ–≤
- **TEAM** (Team-–ª–∏–¥–µ—Ä) ‚Äî —Å–æ–∑–¥–∞—ë—Ç Call-–º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤
- **CALL** (Call-–º–µ–Ω–µ–¥–∂–µ—Ä) ‚Äî –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤

### API Endpoints

#### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- `POST /token` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ JWT-—Ç–æ–∫–µ–Ω–∞

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- `POST /users/create_team_with_lead` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã —Å –ª–∏–¥–µ—Ä–æ–º (ADMIN)
- `POST /users/create_call_team` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ Call-–º–µ–Ω–µ–¥–∂–µ—Ä–∞ (TEAM)

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞–º–∏
- `GET /clients/` ‚Äî —Å–ø–∏—Å–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤ (—Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ —Ä–æ–ª–∏)
- `POST /clients/` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ (ADMIN)
- `GET /clients/{client_id}` ‚Äî –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∏–µ–Ω—Ç–µ
- `POST /clients/{client_id}/assign_call/{call_id}` ‚Äî –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ –Ω–∞ Call-–º–µ–Ω–µ–¥–∂–µ—Ä–∞ (TEAM)

### –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö
- **Client**: –∏–º—è, email, —Ç–µ–ª–µ—Ñ–æ–Ω, —Å—Ç–∞—Ç—É—Å, —Å–≤—è–∑—å —Å –∫–æ–º–∞–Ω–¥–æ–π –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, —Ç–µ–≥–∏
- **User**: username, password, —Ä–æ–ª—å, –ø—Ä–∏–≤—è–∑–∫–∞ –∫ –∫–æ–º–∞–Ω–¥–µ
- **Team**: –Ω–∞–∑–≤–∞–Ω–∏–µ, —Å–≤—è–∑—å —Å –∞–¥–º–∏–Ω–æ–º, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –∫–ª–∏–µ–Ω—Ç–∞–º–∏
- **Tag**: —Å–∏—Å—Ç–µ–º–∞ —Ç–µ–≥–æ–≤ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ (many-to-many)
- **Admin**: –æ—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

#### –°—Ç–∞—Ç—É—Å—ã –∫–ª–∏–µ–Ω—Ç–æ–≤
- `NEW` ‚Äî –Ω–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç
- `IN_WORK` ‚Äî –≤ —Ä–∞–±–æ—Ç–µ
- `CLOSED` ‚Äî –∑–∞–∫—Ä—ã—Ç
- `DEAD` ‚Äî –Ω–µ –∞–∫—Ç—É–∞–ª–µ–Ω
- `STUCK` ‚Äî –∑–∞—Å—Ç–æ–ø–æ—Ä–∏–ª—Å—è

---

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ (—Ç—Ä–µ–±—É—é—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
1. **–ü–∞—Ä–æ–ª–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ** ‚Äî –Ω–µ—Ç —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
2. **SECRET_KEY –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω** ‚Äî –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. **DATABASE_URL –≤ –∫–æ–¥–µ** ‚Äî –∫—Ä–µ–¥–µ–Ω—à–∞–ª—ã –ë–î –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ `.env`
4. **JWT –±–µ–∑ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è** ‚Äî —Ç–æ–∫–µ–Ω—ã –¥–µ–π—Å—Ç–≤—É—é—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ
5. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–æ—É—Ç–æ–≤** ‚Äî —Ñ—É–Ω–∫—Ü–∏—è `assign_client_to_call` –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –¥–≤–∞–∂–¥—ã
6. **–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ enum'–æ–≤** ‚Äî `UserRole` –∏–º–µ–µ—Ç —Ä–∞–∑–Ω—ã–π —Ä–µ–≥–∏—Å—Ç—Ä –≤ models –∏ schemas

### –¢—Ä–µ–±—É—é—Ç —É–ª—É—á—à–µ–Ω–∏—è
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—è email –∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- –ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –ë–î
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏—è
- –ù–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç —Ç–µ—Å—Ç—ã
- –ù–µ —Å–æ–∑–¥–∞–Ω `docker-compose.yml`

---

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python 3.11+
- PostgreSQL
- Poetry

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
poetry install
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
1. –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö PostgreSQL:
```sql
CREATE DATABASE crm_db;
CREATE USER crm_user WITH PASSWORD '1234';
GRANT ALL PRIVILEGES ON DATABASE crm_db TO crm_user;
```

2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
```bash
alembic upgrade head
```

### –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
```bash
uvicorn crm_app.main:app --reload
```

API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:8000`
–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: `http://localhost:8000/docs`

---

## üìù TODO

- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π (bcrypt)
- [ ] –í—ã–Ω–µ—Å—Ç–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- [ ] –î–æ–±–∞–≤–∏—Ç—å JWT expiration
- [ ] –ò—Å–ø—Ä–∞–≤–∏—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–æ—É—Ç–æ–≤
- [ ] –°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä –≤ UserRole enum
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –ø–æ–ª–µ–π
- [ ] –°–æ–∑–¥–∞—Ç—å docker-compose.yml
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–∞–≥–∏–Ω–∞—Ü–∏—é
